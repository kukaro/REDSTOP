# 25

## Writing Data

아래의 링크는 writing에 대한 doc

{% embed data="{\"url\":\"https://docs.influxdata.com/influxdb/v1.6/guides/writing\_data/\",\"type\":\"link\",\"title\":\"InfluxData Documentation\",\"description\":\"Documentation for InfluxDB, Telegraf, Chronograf, and Kapacitor\",\"icon\":{\"type\":\"icon\",\"url\":\"https://docs.influxdata.com/img/favicon.ico\",\"aspectRatio\":0},\"thumbnail\":{\"type\":\"thumbnail\",\"url\":\"https://docs.influxdata.com/img/influx-logo-cubo-dark.png\",\"width\":900,\"height\":900,\"aspectRatio\":1}}" %}

지금부터, CLI가 아닌 HTTP API를 이용해서 Data를 Write하는 방법을 알아보자

curl로 HTTP Request를 때려서 Data를 쓴다



**Create Database**

```text
$curl -i -XPOST http://localhost:8086/query --data-urlencode "q=CREATE DATABASE <db이름>"
```

POST 로, url은 /query, db이름과 endpoint 주소 입력. q=  뒤에 쿼리문

커맨드창에서 입력하면 200 OK응답을 받는다.

CLI에서 확인해보면, db가 잘 생긴걸 확인할 수 있다.



**Writing data using HTTP API**

```bash
$curl -i -XPOST 'http://localhost:8086/write?db=mydb' --data-binary 'cpu_load_short,host=server01,region=us-west value=0.64 1434055562000000000'
```

POST, url은 /write , 반드시 db이름을 명시해줘야 한다.

The example below writes a single point to the `mydb` database. The data consist of the [measurement](https://docs.influxdata.com/influxdb/v1.6/concepts/glossary/#measurement) `cpu_load_short`, the [tag keys](https://docs.influxdata.com/influxdb/v1.6/concepts/glossary/#tag-key) `host` and `region` with the [tag values](https://docs.influxdata.com/influxdb/v1.6/concepts/glossary/#tag-value) `server01` and `us-west`, the [field key](https://docs.influxdata.com/influxdb/v1.6/concepts/glossary/#field-key) `value` with a [field value](https://docs.influxdata.com/influxdb/v1.6/concepts/glossary/#field-value) of `0.64`, and the [timestamp](https://docs.influxdata.com/influxdb/v1.6/concepts/glossary/#timestamp) `1434055562000000000`. 

`rp` query parameter로 retention policy 지정 가능



## Querying Data

아래의 링크는 querying에 대한 doc

{% embed data="{\"url\":\"https://docs.influxdata.com/influxdb/v1.6/guides/querying\_data/\",\"type\":\"link\",\"title\":\"InfluxData Documentation\",\"description\":\"Documentation for InfluxDB, Telegraf, Chronograf, and Kapacitor\",\"icon\":{\"type\":\"icon\",\"url\":\"https://docs.influxdata.com/img/favicon.ico\",\"aspectRatio\":0},\"thumbnail\":{\"type\":\"thumbnail\",\"url\":\"https://docs.influxdata.com/img/influx-logo-cubo-dark.png\",\"width\":900,\"height\":900,\"aspectRatio\":1}}" %}

## Key Concept

InfluxDB의 핵심 컨셉에 대한 설명

{% embed data="{\"url\":\"https://docs.influxdata.com/influxdb/v1.6/concepts/key\_concepts/\",\"type\":\"link\",\"title\":\"InfluxData Documentation\",\"description\":\"Documentation for InfluxDB, Telegraf, Chronograf, and Kapacitor\",\"icon\":{\"type\":\"icon\",\"url\":\"https://docs.influxdata.com/img/favicon.ico\",\"aspectRatio\":0},\"thumbnail\":{\"type\":\"thumbnail\",\"url\":\"https://docs.influxdata.com/img/influx-logo-cubo-dark.png\",\"width\":900,\"height\":900,\"aspectRatio\":1}}" %}

* tag는 Indexing이 안되니까 조회할 때 훨씬 빠르다
* A single measurement can belong to different retention policies. A _**retention policy**_ describes how long InfluxDB keeps data \(`DURATION`\) and how many copies of those data are stored in the cluster \(`REPLICATION`\). If you’re interested in reading more about retention policies, check out [Database Management](https://docs.influxdata.com/influxdb/v1.6/query_language/database_management/#retention-policy-management).
* In InfluxDB, a _**series**_ is the collection of data that share a retention policy, measurement, and tag set.
* a _**point**_ is the field set in the same series with the same timestamp



**예시\)**

4개의 Series

| Arbitrary series number | Retention policy | Measurement | Tag set |
| :--- | :--- | :--- | :--- |
| series 1 | `autogen` | `census` | `location = 1`,`scientist = langstroth` |
| series 2 | `autogen` | `census` | `location = 2`,`scientist = langstroth` |
| series 3 | `autogen` | `census` | `location = 1`,`scientist = perpetua` |
| series 4 | `autogen` | `census` | `location = 2`,`scientist = perpetua` |

하나의 Point

```text
name: census
-----------------
time                    butterflies honeybees   location    scientist
2015-08-18T00:00:00Z    1           30          1           perpetua
```

The series in the example is defined by the retention policy \(`autogen`\), the measurement \(`census`\), and the tag set \(`location = 1`, `scientist = perpetua`\). The timestamp for the point is `20`

